{% extends "base.html" %}

{% block content %}
  <style>
    /* Laurel via mask (single asset), responsive box */
    .laurel-crest{
      width: clamp(150px, 30vw, 600px);
      height: clamp(150px, 30vw, 600px);
      margin: 0 auto 1rem;
      background-image: url('{{ get_url(path="laurels-black.svg", cachebust=true) }}');
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0.75;
    }
    :root[data-theme="dark"] .laurel-crest{
      filter: invert(0.75);
    }
  </style>

  <section style="margin: 2rem 0 2.5rem;">
    <h1 style="margin: 0 0 .25rem 0;">{{ section.title }}</h1>
    <p style="margin: .5rem 0 0 0; font-size: 1.05rem; line-height: 1.6;">
      {{ section.content | safe }}
    </p>
    <div class="laurel-crest" aria-hidden="true"></div>
  </section>

  {# Latest posts (no pagination on the home). Adjust count as you like. #}
  {# Grab the three sections #}
  {% set sw = get_section(path="software/_index.md") %}
  {% set ma = get_section(path="maths/_index.md") %}
  {% set ph = get_section(path="philosophia/_index.md") %}

  {# Merge pages and sort newest -> oldest #}
  {% set all = sw.pages | concat(with=ma.pages) | concat(with=ph.pages) %}
  {% set all = all | sort(attribute="date") | reverse %}

  {# Optional: drop drafts if you ever build with drafts enabled #}
  {# {% set all = all | filter(attribute="draft", value=false) %} #}

  {% if all | length > 0 %}
    <section aria-labelledby="latest">
      <h2 id="latest" style="margin: 0 0 .75rem 0;">Latest</h2>
      <ul style="list-style: none; padding: 0; margin: 0;">
        {% for p in all | slice(end=5) %}
          <li style="margin: 0 0 1rem 0;">
            <a href="{{ p.permalink }}" style="font-weight: 600; text-decoration: none;">
              {{ p.title }}
            </a>
            {% if p.date %}
              <div style="font-size: .9rem; opacity: .7;">
                {{ p.date | date(format="%Y-%m-%d") }}
              </div>
            {% endif %}

            {% if p.summary %}
              <p style="margin: .35rem 0 0 0;">{{ p.summary | safe }}</p>
            {% elif p.description %}
              <p style="margin: .35rem 0 0 0;">{{ p.description }}</p>
            {% endif %}
          </li>
        {% endfor %}
      </ul>

      {% if all | length > 5 %}
        <p style="margin-top: 1rem;"><a href="/posts/">All posts â†’</a></p>
      {% endif %}
    </section>
  {% endif %}
{% endblock content %}
